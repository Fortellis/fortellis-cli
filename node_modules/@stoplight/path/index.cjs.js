"use strict";function format(e){let r="";return e.absolute&&("file"===e.protocol?(e.drive&&(r+=e.drive),r+="/"):(r+=e.protocol+"://",e.origin&&(r+=e.origin+"/"))),""===(r+=e.path.join("/"))&&(r="."),r}function peg$subclass(e,r){function t(){this.constructor=e}t.prototype=r.prototype,e.prototype=new t}function peg$SyntaxError(e,r,t,n){this.message=e,this.expected=r,this.found=t,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}function peg$parse(e,r){r=void 0!==r?r:{};var t,n,o,a,s={},i={Path:0},u=0,l=[function(e,r,t,n){return{protocol:e,origin:r,absolute:!0,...t,...n}},function(e,r,t){return{protocol:e,origin:r,absolute:!0,...t,path:[]}},"http://",d("http://",!0),function(e){return"http"},"https://",d("https://",!0),function(e){return"https"},"",function(){return null},function(e,r,t){return{protocol:e,origin:null,absolute:!0,...r,...t}},"file://",d("file://",!0),"file:",d("file:",!0),function(e){return"file"},function(e,r){return{protocol:"file",origin:null,absolute:!0,...e,...r}},function(){return{drive:null}},/^[A-Za-z]/,m([["A","Z"],["a","z"]],!1,!1),":",d(":",!1),function(e){return{drive:e.toLowerCase()+":"}},function(){return{drive:null}},function(e){return{protocol:null,origin:null,absolute:!1,drive:null,...e}},function(e){return{path:e}},function(e,r){return[e,...r]},function(e){return[e]},".",d(".",!1),"/",d("/",!1),"\\",d("\\",!1),/^[^\/\\]/,m(["/","\\"],!0,!1)],p=[k(";!./ &;&.) &;(.# &;-"),k("%;\"/F#;%/=$;*/4$;./+$8$: $$#\"! )($'#(#'#(\"'#&'#.F &%;\"/<#;%/3$;,/*$8#:!##\"! )(#'#(\"'#&'#"),k(";#.# &;$"),k('%3"""5\'7#/\' 8!:$!! )'),k("%3%\"\"5(7&/' 8!:'!! )"),k('%$;5/&#0#*;5&&&#/"!&,).. &% (/& 8!:)! )'),k("%;'/<#;)/3$;./*$8#:*##\"! )(#'#(\"'#&'#"),k('%3+""5\'7,.) &3-""5%7./\' 8!:/!! )'),k('%;)/2#;./)$8":0""! )("\'#&\'#'),k(";*.# &;+"),k("%;4/& 8!:1! )"),k('%42""5!73/@#24""6475/1$;4/($8#:6#!")(#\'#("\'#&\'#'),k("% (/& 8!:7! )"),k('%;0/1#;./($8":8"! )("\'#&\'#'),k("%;//' 8!:9!! )"),k("%;1/;#;4/2$;//)$8#::#\"\" )(#'#(\"'#&'#./ &%;1/' 8!:;!! )"),k(";2.# &;3"),k('%$;5/&#0#*;5&&&#/"!&,).# & ('),k('%2<""6<7=/,#;4/#$+")("\'#&\'#'),k(" ("),k('2>""6>7?.) &2@""6@7A'),k('4B""5!7C')],c=0,h=[{line:1,column:1}],f=0,g=[],b=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');u=i[r.startRule]}function d(e,r){return{type:"literal",text:e,ignoreCase:r}}function m(e,r,t){return{type:"class",parts:e,inverted:r,ignoreCase:t}}function x(r){var t,n=h[r];if(n)return n;for(t=r-1;!h[t];)t--;for(n={line:(n=h[t]).line,column:n.column};t<r;)10===e.charCodeAt(t)?(n.line++,n.column=1):n.column++,t++;return h[r]=n,n}function $(e,r){var t=x(e),n=x(r);return{start:{offset:e,line:t.line,column:t.column},end:{offset:r,line:n.line,column:n.column}}}function v(e){c<f||(c>f&&(f=c,g=[]),g.push(e))}function k(e){var r,t=new Array(e.length);for(r=0;r<e.length;r++)t[r]=e.charCodeAt(r)-32;return t}if((t=function r(t){for(var n,o,a=p[t],i=0,u=[],h=a.length,f=[],g=[];;){for(;i<h;)switch(a[i]){case 0:g.push(l[a[i+1]]),i+=2;break;case 1:g.push(void 0),i++;break;case 2:g.push(null),i++;break;case 3:g.push(s),i++;break;case 4:g.push([]),i++;break;case 5:g.push(c),i++;break;case 6:g.pop(),i++;break;case 7:c=g.pop(),i++;break;case 8:g.length-=a[i+1],i+=2;break;case 9:g.splice(-2,1),i++;break;case 10:g[g.length-2].push(g.pop()),i++;break;case 11:g.push(g.splice(g.length-a[i+1],a[i+1])),i+=2;break;case 12:g.push(e.substring(g.pop(),c)),i++;break;case 13:f.push(h),u.push(i+3+a[i+1]+a[i+2]),g[g.length-1]?(h=i+3+a[i+1],i+=3):(h=i+3+a[i+1]+a[i+2],i+=3+a[i+1]);break;case 14:f.push(h),u.push(i+3+a[i+1]+a[i+2]),g[g.length-1]===s?(h=i+3+a[i+1],i+=3):(h=i+3+a[i+1]+a[i+2],i+=3+a[i+1]);break;case 15:f.push(h),u.push(i+3+a[i+1]+a[i+2]),g[g.length-1]!==s?(h=i+3+a[i+1],i+=3):(h=i+3+a[i+1]+a[i+2],i+=3+a[i+1]);break;case 16:g[g.length-1]!==s?(f.push(h),u.push(i),h=i+2+a[i+1],i+=2):i+=2+a[i+1];break;case 17:f.push(h),u.push(i+3+a[i+1]+a[i+2]),e.length>c?(h=i+3+a[i+1],i+=3):(h=i+3+a[i+1]+a[i+2],i+=3+a[i+1]);break;case 18:f.push(h),u.push(i+4+a[i+2]+a[i+3]),e.substr(c,l[a[i+1]].length)===l[a[i+1]]?(h=i+4+a[i+2],i+=4):(h=i+4+a[i+2]+a[i+3],i+=4+a[i+2]);break;case 19:f.push(h),u.push(i+4+a[i+2]+a[i+3]),e.substr(c,l[a[i+1]].length).toLowerCase()===l[a[i+1]]?(h=i+4+a[i+2],i+=4):(h=i+4+a[i+2]+a[i+3],i+=4+a[i+2]);break;case 20:f.push(h),u.push(i+4+a[i+2]+a[i+3]),l[a[i+1]].test(e.charAt(c))?(h=i+4+a[i+2],i+=4):(h=i+4+a[i+2]+a[i+3],i+=4+a[i+2]);break;case 21:g.push(e.substr(c,a[i+1])),c+=a[i+1],i+=2;break;case 22:g.push(l[a[i+1]]),c+=l[a[i+1]].length,i+=2;break;case 23:g.push(s),0===b&&v(l[a[i+1]]),i+=2;break;case 24:g[g.length-1-a[i+1]],i+=2;break;case 25:c,i++;break;case 26:for(n=a.slice(i+4,i+4+a[i+3]),o=0;o<a[i+3];o++)n[o]=g[g.length-1-n[o]];g.splice(g.length-a[i+2],a[i+2],l[a[i+1]].apply(null,n)),i+=4+a[i+3];break;case 27:g.push(r(a[i+1])),i+=2;break;case 28:b++,i++;break;case 29:b--,i++;break;default:throw new Error("Invalid opcode: "+a[i]+".")}if(!(f.length>0))break;h=f.pop(),i=u.pop()}return g[0]}(u))!==s&&c===e.length)return t;throw t!==s&&c<e.length&&v({type:"end"}),n=g,o=f<e.length?e.charAt(f):null,a=f<e.length?$(f,f+1):$(f,f),new peg$SyntaxError(peg$SyntaxError.buildMessage(n,o),n,o,a)}Object.defineProperty(exports,"__esModule",{value:!0}),peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(e,r){var t={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var r,t="";for(r=0;r<e.parts.length;r++)t+=e.parts[r]instanceof Array?a(e.parts[r][0])+"-"+a(e.parts[r][1]):a(e.parts[r]);return"["+(e.inverted?"^":"")+t+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+n(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+n(e)})}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+n(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+n(e)})}return"Expected "+function(e){var r,n,o,a=new Array(e.length);for(r=0;r<e.length;r++)a[r]=(o=e[r],t[o.type](o));if(a.sort(),a.length>0){for(r=1,n=1;r<a.length;r++)a[r-1]!==a[r]&&(a[n]=a[r],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(r)+" found."};var grammar={SyntaxError:peg$SyntaxError,parse:peg$parse},grammar_1=grammar.parse;function parse(e){if("string"!=typeof e)throw new Error(`@stoplight/path: Cannot parse ${e} because it is not a string`);return grammar_1(e,{})}function normalize(e){return format(normalizeParsed(parse(e)))}function normalizeParsed(e){let r=e.path;r=r.filter(e=>""!==e&&"."!==e);const t=[];for(const n of r)".."===n&&t.length&&".."!==t[t.length-1]?t.pop():".."===n&&e.absolute||t.push(n);return e.path=t,e}function parseBase(e){let r=e.lastIndexOf(".");".."===e&&(r=-1),"."===e&&(r=-1);let t=e,n="";return r>0&&(t=e.slice(0,r),n=e.slice(r)),{name:t,ext:n}}const basename=(e,r)=>{const t=normalizeParsed(parse(e)).path.pop();if(!t)return"";const{name:n,ext:o}=parseBase(t);return!0===r||r===o?n:`${n}${o}`},dirname=e=>{const r=normalizeParsed(parse(e));return r.path.pop(),format(normalizeParsed(r))},extname=e=>{const r=normalizeParsed(parse(e)).path.pop();if(!r)return"";const{ext:t}=parseBase(r);return t};function isAbsolute(e){return parse(e).absolute}function isURL(e){const r=parse(e);return"http"===r.protocol||"https"===r.protocol}const join=(...e)=>{if(0===e.length)return".";const r=e.map(parse),t=Object.assign({},r[0]);for(let n=1;n<r.length;n++){const o=r[n];if(o.absolute)throw new Error('Cannot join an absolute path "'+e[n]+'" in the middle of other paths.');for(const e of o.path)t.path.push(e)}return format(normalizeParsed(t))};function relative(e,r){const t=normalizeParsed(parse(r));if(!t.absolute)return format(t);const n=normalizeParsed(parse(e));if(t.origin!==n.origin)return format(t);if(!n.absolute)return format(t);if(n.drive!==t.drive)return format(t);const o=Math.min(n.path.length,t.path.length);for(let e=0;e<o&&n.path[0]===t.path[0];e++)n.path.shift(),t.path.shift();return t.path.unshift(...n.path.fill("..")),format({origin:null,drive:null,absolute:!1,protocol:null,path:t.path})}function resolve(...e){if(0===e.length)return".";const r=normalizeParsed(parse(e[e.length-1]));return r.absolute?format(r):join(...e)}const sep="/",startsWithWindowsDrive=e=>{return null!==parse(e).drive},stripRoot=e=>parse(e).path.filter(Boolean).join("/");function deserializeSrn(e){const[r,t,n,...o]=e.split("/"),a=o.length?`/${o.join("/")}`:void 0;let s,i;return a&&(s=o.find(e=>e.includes(".")))&&(i=parseBase(s).ext),{shortcode:r,orgSlug:t,projectSlug:n,uri:a,file:s,ext:i}}function serializeSrn({shortcode:e,orgSlug:r,projectSlug:t,uri:n=""}){return[e,r,t,n.replace(/^\//,"")].filter(Boolean).join("/")}exports.basename=basename,exports.deserializeSrn=deserializeSrn,exports.dirname=dirname,exports.extname=extname,exports.format=format,exports.isAbsolute=isAbsolute,exports.isURL=isURL,exports.join=join,exports.normalize=normalize,exports.parse=parse,exports.relative=relative,exports.resolve=resolve,exports.sep="/",exports.serializeSrn=serializeSrn,exports.startsWithWindowsDrive=startsWithWindowsDrive,exports.stripRoot=stripRoot,exports.toFSPath=normalize;
